import { NextResponse } from 'next/server';
import clientPromise from '@/lib/mongodb';

// 30 å¤©çš„é©šå–œå…§å®¹åº«å­˜
const surprisesData = [
  {
    date: "2026-02-06",
    title: "ğŸŒŸ ä»Šæ—¥é‡‘å¥",
    content: "ã€ŒæˆåŠŸä¸æ˜¯çµ‚é»ï¼Œå¤±æ•—ä¹Ÿä¸æ˜¯æœ«æ—¥,æœ€é‡è¦çš„æ˜¯ç¹¼çºŒå‰é€²çš„å‹‡æ°£ã€‚ã€â€” é‚±å‰çˆ¾",
    category: "quote",
    tags: ["å‹µå¿—", "åè¨€"],
  },
  {
    date: "2026-02-07",
    title: "ğŸ¨ å‰µæ„æŒ‘æˆ°",
    content: "ä»Šå¤©è©¦è©¦ç”¨éæ…£ç”¨æ‰‹å¯«å­—æˆ–ç•«åœ–ï¼Œä½ æœƒç™¼ç¾å¤§è…¦çš„å¦ä¸€é¢ï¼",
    category: "challenge",
    tags: ["å‰µæ„", "æŒ‘æˆ°"],
  },
  {
    date: "2026-02-08",
    title: "ğŸ§  å†·çŸ¥è­˜",
    content: "èœ‚èœœæ˜¯å”¯ä¸€ä¸æœƒè…å£çš„é£Ÿç‰©ï¼Œè€ƒå¤å­¸å®¶æ›¾åœ¨å¤åŸƒåŠé‡‘å­—å¡”ä¸­ç™¼ç¾ 3000 å¹´å‰çš„èœ‚èœœï¼Œè‡³ä»Šä»å¯é£Ÿç”¨ï¼",
    category: "fact",
    tags: ["çŸ¥è­˜", "æœ‰è¶£"],
  },
  {
    date: "2026-02-09",
    title: "â˜• ç”Ÿæ´»ææ¡ˆ",
    content: "è©¦è©¦ã€Œç•ªèŒ„å·¥ä½œæ³•ã€ï¼šå°ˆæ³¨ 25 åˆ†é˜ï¼Œä¼‘æ¯ 5 åˆ†é˜ï¼Œä½ æœƒç™¼ç¾æ•ˆç‡å¤§å¢ï¼",
    category: "lifehack",
    tags: ["æ•ˆç‡", "å·¥ä½œ"],
  },
  {
    date: "2026-02-10",
    title: "ğŸµ éŸ³æ¨‚æ¨è–¦",
    content: "è½è½çœ‹ç™½å™ªéŸ³æˆ–è‡ªç„¶éŸ³ï¼ˆé›¨è²ã€æµ·æµªï¼‰ï¼Œèƒ½å¹«åŠ©ä½ æ›´å°ˆæ³¨æˆ–æ”¾é¬†ã€‚",
    category: "music",
    tags: ["éŸ³æ¨‚", "æ”¾é¬†"],
  },
  {
    date: "2026-02-11",
    title: "ğŸŒ æ—…è¡Œéˆæ„Ÿ",
    content: "å†°å³¶çš„ã€Œè—æ¹–æº«æ³‰ã€æ˜¯ä¸–ç•Œæœ€ç¾æº«æ³‰ä¹‹ä¸€ï¼Œåœ¨é›ªåœ°ä¸­æ³¡æº«æ³‰ï¼Œçµ•å°æ˜¯å¤¢å¹»é«”é©—ï¼",
    category: "travel",
    tags: ["æ—…è¡Œ", "æ™¯é»"],
  },
  {
    date: "2026-02-12",
    title: "ğŸ“š æ›¸ç±æ¨è–¦",
    content: "ã€ŠåŸå­ç¿’æ…£ã€‹æ•™ä½ å¦‚ä½•ç”¨å¾®å°æ”¹è®Šå‰µé€ å·¨å¤§æˆå°±ï¼Œæ¯å¤©é€²æ­¥ 1% å°±å¥½ï¼",
    category: "book",
    tags: ["é–±è®€", "æˆé•·"],
  },
  {
    date: "2026-02-13",
    title: "ğŸ³ ç°¡å–®é£Ÿè­œ",
    content: "é›è›‹ + é…ªæ¢¨ + åå¸ = å®Œç¾æ—©é¤ï¼ç‡Ÿé¤Šè±å¯Œåˆç°¡å–®ï¼Œ5 åˆ†é˜æå®šã€‚",
    category: "recipe",
    tags: ["ç¾é£Ÿ", "å¥åº·"],
  },
  {
    date: "2026-02-14",
    title: "ğŸ’ æƒ…äººç¯€ç‰¹åˆ¥ç‰ˆ",
    content: "æœ€æµªæ¼«çš„ä¸æ˜¯æ˜‚è²´çš„ç¦®ç‰©ï¼Œè€Œæ˜¯çœŸå¿ƒçš„é™ªä¼´å’Œä¸€å¥ã€Œæˆ‘æ„›ä½ ã€ã€‚",
    category: "special",
    tags: ["ç¯€æ—¥", "æ„›"],
  },
  {
    date: "2026-02-15",
    title: "ğŸ® éŠæˆ²æ¨è–¦",
    content: "è©¦è©¦ã€Šç´€å¿µç¢‘è°·ã€‹ï¼Œç¾éº—çš„ç•«é¢å’Œå‰µæ„çš„é—œå¡è¨­è¨ˆæœƒè®“ä½ é©šè‰·ï¼",
    category: "game",
    tags: ["éŠæˆ²", "å‰µæ„"],
  },
  {
    date: "2026-02-16",
    title: "ğŸ§˜ æ­£å¿µç·´ç¿’",
    content: "é–‰ä¸Šçœ¼ç›ï¼Œæ·±å‘¼å¸ 3 æ¬¡ï¼Œå°ˆæ³¨åœ¨å‘¼å¸ä¸Šï¼Œæ„Ÿå—ç•¶ä¸‹ï¼Œé‡‹æ”¾å£“åŠ›ã€‚",
    category: "mindfulness",
    tags: ["æ­£å¿µ", "æ”¾é¬†"],
  },
  {
    date: "2026-02-17",
    title: "ğŸ¬ é›»å½±æ¨è–¦",
    content: "ã€Šå¿ƒéˆæ•æ‰‹ã€‹æ•™æˆ‘å€‘ï¼šæœ‰æ™‚å€™ï¼Œæˆ‘å€‘éœ€è¦çš„åªæ˜¯ä¸€å€‹çœŸæ­£æ‡‚æˆ‘å€‘çš„äººã€‚",
    category: "movie",
    tags: ["é›»å½±", "å‹µå¿—"],
  },
  {
    date: "2026-02-18",
    title: "ğŸŒ± æ¤ç‰©å°çŸ¥è­˜",
    content: "è™å°¾è˜­å¯ä»¥åœ¨å¤œé–“é‡‹æ”¾æ°§æ°£ï¼Œæ˜¯è‡¥å®¤çš„æœ€ä½³æ¤ç‰©é¸æ“‡ï¼",
    category: "plant",
    tags: ["æ¤ç‰©", "å±…å®¶"],
  },
  {
    date: "2026-02-19",
    title: "ğŸ’ª é‹å‹•æŒ‘æˆ°",
    content: "ä»Šå¤©åš 10 å€‹æ·±è¹²ï¼ç°¡å–®çš„é–‹å§‹ï¼Œé¤Šæˆé‹å‹•ç¿’æ…£ã€‚",
    category: "exercise",
    tags: ["é‹å‹•", "å¥åº·"],
  },
  {
    date: "2026-02-20",
    title: "ğŸ¨ è—è¡“è³æ",
    content: "æ¢µè°·çš„ã€Šæ˜Ÿå¤œã€‹å……æ»¿å‹•æ„Ÿå’Œæƒ…æ„Ÿï¼Œæ“šèªªæ˜¯ä»–åœ¨ç²¾ç¥ç—…é™¢æ™‚å‰µä½œçš„ã€‚",
    category: "art",
    tags: ["è—è¡“", "æ–‡åŒ–"],
  },
  {
    date: "2026-02-21",
    title: "ğŸ± å¯æ„›å‹•ç‰©",
    content: "è²“å’ªæ¯å¤©è¦ç¡ 12-16 å°æ™‚ï¼Œé›£æ€ªç‰ å€‘ç¸½æ˜¯ä¸€å‰¯æ…µæ‡¶çš„æ¨£å­ï¼",
    category: "animal",
    tags: ["å‹•ç‰©", "å¯æ„›"],
  },
  {
    date: "2026-02-22",
    title: "â˜€ï¸ å¥½å¤©æ°£ææ¡ˆ",
    content: "ä»Šå¤©å¤©æ°£å¥½å—ï¼Ÿå‡ºé–€èµ°èµ°ï¼Œæ›¬æ›¬å¤ªé™½ï¼Œè£œå……ç¶­ç”Ÿç´  Dï¼",
    category: "weather",
    tags: ["æˆ¶å¤–", "å¥åº·"],
  },
  {
    date: "2026-02-23",
    title: "ğŸ¯ ç›®æ¨™è¨­å®š",
    content: "æŠŠå¤§ç›®æ¨™åˆ†æˆå°æ­¥é©Ÿï¼Œæ¯å®Œæˆä¸€æ­¥å°±çå‹µè‡ªå·±ï¼",
    category: "goal",
    tags: ["ç›®æ¨™", "æˆé•·"],
  },
  {
    date: "2026-02-24",
    title: "ğŸŒˆ å¿ƒæƒ…ç™‚ç™’",
    content: "å¿ƒæƒ…ä¸å¥½æ™‚ï¼Œè©¦è©¦å¯«ä¸‹ 3 ä»¶ä»Šå¤©æ„Ÿæ©çš„äº‹ï¼Œå¿ƒæƒ…æœƒè®Šå¥½å–”ï¼",
    category: "healing",
    tags: ["ç™‚ç™’", "æ­£èƒ½é‡"],
  },
  {
    date: "2026-02-25",
    title: "ğŸ“ å­¸ç¿’æŠ€å·§",
    content: "è²»æ›¼å­¸ç¿’æ³•ï¼šæŠŠå­¸åˆ°çš„æ±è¥¿ç”¨ç°¡å–®çš„è©±è¬›çµ¦åˆ¥äººè½ï¼Œå°±æ˜¯æœ€å¥½çš„è¤‡ç¿’ï¼",
    category: "learning",
    tags: ["å­¸ç¿’", "æŠ€å·§"],
  },
  {
    date: "2026-02-26",
    title: "ğŸŒ™ ç¡çœ å°è²¼å£«",
    content: "ç¡å‰ä¸€å°æ™‚ä¸çœ‹æ‰‹æ©Ÿï¼Œæ”¹çœ‹ç´™æœ¬æ›¸ï¼Œç¡çœ å“è³ªæœƒæ›´å¥½ï¼",
    category: "sleep",
    tags: ["ç¡çœ ", "å¥åº·"],
  },
  {
    date: "2026-02-27",
    title: "ğŸ é€ç¦®éˆæ„Ÿ",
    content: "æœ€å¥½çš„ç¦®ç‰©æ˜¯ã€Œæ™‚é–“ã€ï¼šé™ªå®¶äººåƒé£¯ã€é™ªæœ‹å‹èŠå¤©ï¼Œéƒ½æ˜¯ç„¡åƒ¹çš„ç¦®ç‰©ã€‚",
    category: "gift",
    tags: ["ç¦®ç‰©", "é—œä¿‚"],
  },
  {
    date: "2026-02-28",
    title: "ğŸŒ¸ æ˜¥å¤©ä¾†äº†",
    content: "æ«»èŠ±å­£å¿«åˆ°äº†ï¼è¦åŠƒä¸€ä¸‹è³æ«»è¡Œç¨‹ï¼Œæ„Ÿå—æ˜¥å¤©çš„ç¾å¥½ã€‚",
    category: "season",
    tags: ["å­£ç¯€", "è‡ªç„¶"],
  },
  {
    date: "2026-03-01",
    title: "ğŸ“± æ•¸ä½æ’æ¯’",
    content: "è©¦è©¦ä»Šå¤©ä¸æ»‘ç¤¾ç¾¤åª’é«” 1 å°æ™‚ï¼Œä½ æœƒç™¼ç¾æ™‚é–“è®Šå¤šäº†ï¼",
    category: "digital",
    tags: ["æ•¸ä½", "ç”Ÿæ´»"],
  },
  {
    date: "2026-03-02",
    title: "ğŸª è¶£å‘³æ´»å‹•",
    content: "å’Œæœ‹å‹ç©æ¡ŒéŠï¼Œé‡æº«é¢å°é¢äº’å‹•çš„æ¨‚è¶£ï¼",
    category: "activity",
    tags: ["å¨›æ¨‚", "ç¤¾äº¤"],
  },
  {
    date: "2026-03-03",
    title: "ğŸŒŸ æ¯æ—¥è‚¯å®š",
    content: "å°é¡å­èªªï¼šã€Œæˆ‘å¾ˆæ£’ï¼ã€è‡ªä¿¡å¾è‚¯å®šè‡ªå·±é–‹å§‹ã€‚",
    category: "affirmation",
    tags: ["æ­£èƒ½é‡", "è‡ªä¿¡"],
  },
  {
    date: "2026-03-04",
    title: "ğŸ° ç”œé»æ™‚å…‰",
    content: "åƒä¸€å¡Šå–œæ­¡çš„ç”œé»ï¼Œå¥½å¥½çŠ’è³è‡ªå·±ï¼Œå¿«æ¨‚å¾ˆç°¡å–®ï¼",
    category: "dessert",
    tags: ["ç¾é£Ÿ", "äº«å—"],
  },
  {
    date: "2026-03-05",
    title: "ğŸ¨ æ‰‹ä½œæ¨‚è¶£",
    content: "è©¦è©¦æ‘ºç´™æˆ–åšæ‰‹å·¥ï¼Œå‰µä½œéç¨‹æœ¬èº«å°±å¾ˆç™‚ç™’ã€‚",
    category: "craft",
    tags: ["æ‰‹ä½œ", "å‰µæ„"],
  },
  {
    date: "2026-03-07",
    title: "ğŸŒŠ å¤§è‡ªç„¶ç™‚ç™’",
    content: "æµ·é‚Šæ•£æ­¥ã€æ£®æ—æµ´ï¼Œå¤§è‡ªç„¶æ˜¯æœ€å¥½çš„ç™‚ç™’å¸«ã€‚",
    category: "nature",
    tags: ["è‡ªç„¶", "æ”¾é¬†"],
  },
  {
    date: "2026-03-08",
    title: "ğŸ’Œ å¯«å°ä¿¡",
    content: "æ‰‹å¯«ä¸€å°ä¿¡çµ¦é‡è¦çš„äººï¼Œæ¯”è¨Šæ¯æ›´æœ‰æº«åº¦ã€‚",
    category: "letter",
    tags: ["æ›¸å¯«", "æƒ…æ„Ÿ"],
  },
];

export async function POST() {
  try {
    const client = await clientPromise;
    const db = client.db('SurpriseCornerDB');
    const collection = db.collection('surprises');

    // æ‰¹é‡æ’å…¥è³‡æ–™ï¼ˆå¦‚æœæ—¥æœŸå·²å­˜åœ¨å‰‡è·³éï¼‰
    const result = await collection.insertMany(
      surprisesData.map(item => ({
        ...item,
        createdAt: new Date(),
      })),
      { ordered: false } // é‡åˆ°é‡è¤‡ä¸åœæ­¢
    ).catch(err => {
      // å¿½ç•¥é‡è¤‡éŒ¯èª¤
      if (err.code === 11000) {
        return { insertedCount: 0 };
      }
      throw err;
    });

    return NextResponse.json({
      success: true,
      message: `æˆåŠŸåŒ¯å…¥ ${result.insertedCount} ç­†è³‡æ–™`,
      total: surprisesData.length,
    });

  } catch (error) {
    console.error('åŒ¯å…¥è³‡æ–™éŒ¯èª¤:', error);
    return NextResponse.json(
      { error: 'åŒ¯å…¥å¤±æ•—' },
      { status: 500 }
    );
  }
}

// â­ é‡è¦ï¼šåŠ ä¸Šé€™è¡Œè§£æ±º Vercel ç·¨è­¯éŒ¯èª¤
export const dynamic = 'force-dynamic';